"use strict";var window,actionSubscription,name="ShopItemColorManager",isEnabled=!0,COLORS=[28,28,28,7],DEFAULT_COLOR=28,HAT_RANDOM=!0,TSHIRT_RANDOM=!0,UMBRELLA_RANDOM=!0,BALLOON_RANDOM=!0;function getRandomColor(){return Math.floor(32*Math.random())}function getColoredItemId(e,i){var n=e;return 0!=i&&4!=i&&18!=i&&20!=i||(n=i),n}function getNewColorSettings(e,i,n){var o=DEFAULT_COLOR,t=getColoredItemId(i,n);return 18===t?(HAT_RANDOM&&(COLORS[0]=getRandomColor()),o=COLORS[0],void 0!==window&&(window.findWidget("hat_picker").colour=COLORS[0])):20===t?(TSHIRT_RANDOM&&(COLORS[1]=getRandomColor()),o=COLORS[1],void 0!==window&&(window.findWidget("ts_picker").colour=COLORS[1])):4===t?(UMBRELLA_RANDOM&&(COLORS[2]=getRandomColor()),o=COLORS[2],void 0!==window&&(window.findWidget("umb_picker").colour=COLORS[2])):0===t&&(BALLOON_RANDOM&&(COLORS[3]=getRandomColor()),o=COLORS[3],void 0!==window&&(window.findWidget("bal_picker").colour=COLORS[3])),{ride:e,type:0,value:o,index:0}}function initColors(){COLORS[0]=getRandomColor(),COLORS[1]=getRandomColor(),COLORS[2]=getRandomColor(),COLORS[3]=getRandomColor()}function setRandomization(e){HAT_RANDOM=isEnabled,TSHIRT_RANDOM=isEnabled,UMBRELLA_RANDOM=isEnabled,BALLOON_RANDOM=isEnabled}function enablePlugin(e){(isEnabled=e)?void 0===actionSubscription&&initialize():destroy()}function openMainWindow(){void 0!==window&&window.close(),window=ui.openWindow({classification:name,title:name,width:300,height:190,widgets:[{type:"checkbox",name:"manage",x:10,y:20,width:300,height:20,isChecked:isEnabled,text:"Manage item colors for all new stalls",onChange:function(e){enablePlugin(e)}},{type:"label",name:"hat_label",x:15,y:53,width:80,height:20,text:"HATS:"},{type:"colourpicker",name:"hat_picker",x:100,y:53,width:20,height:20,colour:COLORS[0],isChecked:isEnabled,onChange:function(e){COLORS[0]=e}},{type:"checkbox",name:"hat_random",x:130,y:50,width:170,height:20,isChecked:HAT_RANDOM,text:"Random for every stall",onChange:function(e){HAT_RANDOM=e}},{type:"label",name:"ts_label",x:15,y:73,width:80,height:20,text:"T-SHIRTS:"},{type:"colourpicker",name:"ts_picker",x:100,y:73,width:20,height:20,colour:COLORS[1],isChecked:isEnabled,onChange:function(e){COLORS[1]=e}},{type:"checkbox",name:"ts_random",x:130,y:70,width:170,height:20,isChecked:TSHIRT_RANDOM,text:"Random for every stall",onChange:function(e){TSHIRT_RANDOM=e}},{type:"label",name:"umb_label",x:15,y:93,width:80,height:20,text:"UMBRELLAS:"},{type:"colourpicker",name:"umb_picker",x:100,y:93,width:20,height:20,colour:COLORS[2],isChecked:isEnabled,onChange:function(e){COLORS[2]=e}},{type:"checkbox",name:"umb_random",x:130,y:90,width:170,height:20,isChecked:UMBRELLA_RANDOM,text:"Random for every stall",onChange:function(e){UMBRELLA_RANDOM=e}},{type:"label",name:"bal_label",x:15,y:113,width:80,height:20,text:"BALLOONS:"},{type:"colourpicker",name:"bal_picker",x:100,y:113,width:20,height:20,colour:COLORS[3],isChecked:isEnabled,onChange:function(e){COLORS[3]=e}},{type:"checkbox",name:"bal_random",x:130,y:110,width:170,height:20,isChecked:BALLOON_RANDOM,text:"Random for every stall",onChange:function(e){BALLOON_RANDOM=e}},{type:"button",name:"apply_all",x:50,y:150,width:200,height:20,text:"Apply to all existing stalls",onClick:function(){applyToAll()}}]})}function applyToAll(){for(var e=map.rides,i=0;i<e.length;i++){var n=e[i],o=n.type,t=n.id;if(35==o||32==o){var a=getNewColorSettings(t,n.object.shopItem,n.object.shopItemSecondary);context.executeAction("ridesetappearance",a,function(e){})}}}function initialize(){actionSubscription=context.subscribe("action.execute",function(e){var i=e.action,n=e.args;if("ridesetsetting"==i){var o=n.ride,t=map.getRide(o),a=t.type;if(35==a||32==a){var d=getNewColorSettings(o,t.object.shopItem,t.object.shopItemSecondary);context.executeAction("ridesetappearance",d,function(e){})}}}),setRandomization(!0)}function destroy(){void 0!==actionSubscription&&(actionSubscription.dispose(),actionSubscription=void 0);var e=[28,28,28,7];setRandomization(!1),void 0!==window&&(window.findWidget("hat_picker").colour=e[0],window.findWidget("ts_picker").colour=e[1],window.findWidget("umb_picker").colour=e[2],window.findWidget("bal_picker").colour=e[3],window.findWidget("hat_random").isChecked=HAT_RANDOM,window.findWidget("ts_random").isChecked=TSHIRT_RANDOM,window.findWidget("umb_random").isChecked=UMBRELLA_RANDOM,window.findWidget("bal_random").isChecked=BALLOON_RANDOM,window.close())}var main=function(){"undefined"!=typeof ui&&(ui.registerMenuItem(name,function(){openMainWindow()}),isEnabled&&initialize())};registerPlugin({name:name,version:"1.0",licence:"MIT",authors:["gamerlenny"],type:"local",main:main});